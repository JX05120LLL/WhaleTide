{"ast":null,"code":"function _toConsumableArray(r) { return _arrayWithoutHoles(r) || _iterableToArray(r) || _unsupportedIterableToArray(r) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(r, a) { if (r) { if (\"string\" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }\nfunction _iterableToArray(r) { if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r); }\nfunction _arrayWithoutHoles(r) { if (Array.isArray(r)) return _arrayLikeToArray(r); }\nfunction _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }\nimport { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, createStaticVNode as _createStaticVNode } from \"vue\";\nvar _hoisted_1 = {\n  \"class\": \"cart-page\"\n};\nvar _hoisted_2 = {\n  \"class\": \"container\"\n};\nvar _hoisted_3 = {\n  key: 0\n};\nvar _hoisted_4 = {\n  key: 0,\n  \"class\": \"empty-cart\"\n};\nvar _hoisted_5 = {\n  \"class\": \"cart-content\"\n};\nvar _hoisted_6 = {\n  \"class\": \"cart-header\"\n};\nvar _hoisted_7 = {\n  \"class\": \"cart-column select-column\"\n};\nvar _hoisted_8 = {\n  \"class\": \"cart-body\"\n};\nvar _hoisted_9 = {\n  \"class\": \"cart-column select-column\"\n};\nvar _hoisted_10 = {\n  \"class\": \"cart-column item-column\"\n};\nvar _hoisted_11 = {\n  \"class\": \"item-info\"\n};\nvar _hoisted_12 = [\"src\", \"alt\"];\nvar _hoisted_13 = {\n  \"class\": \"item-details\"\n};\nvar _hoisted_14 = {\n  key: 0,\n  \"class\": \"item-attrs\"\n};\nvar _hoisted_15 = {\n  \"class\": \"cart-column price-column\"\n};\nvar _hoisted_16 = {\n  \"class\": \"price\"\n};\nvar _hoisted_17 = {\n  \"class\": \"cart-column quantity-column\"\n};\nvar _hoisted_18 = {\n  \"class\": \"cart-column subtotal-column\"\n};\nvar _hoisted_19 = {\n  \"class\": \"subtotal\"\n};\nvar _hoisted_20 = {\n  \"class\": \"cart-column action-column\"\n};\nvar _hoisted_21 = {\n  \"class\": \"cart-footer\"\n};\nvar _hoisted_22 = {\n  \"class\": \"footer-left\"\n};\nvar _hoisted_23 = {\n  \"class\": \"footer-right\"\n};\nvar _hoisted_24 = {\n  \"class\": \"cart-total\"\n};\nvar _hoisted_25 = {\n  \"class\": \"selected-count\"\n};\nvar _hoisted_26 = {\n  \"class\": \"total-amount\"\n};\nvar _hoisted_27 = {\n  \"class\": \"amount\"\n};\nvar _hoisted_28 = {\n  \"class\": \"loading-container\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_ShoppingCart = _resolveComponent(\"ShoppingCart\");\n  var _component_el_icon = _resolveComponent(\"el-icon\");\n  var _component_el_button = _resolveComponent(\"el-button\");\n  var _component_el_empty = _resolveComponent(\"el-empty\");\n  var _component_el_checkbox = _resolveComponent(\"el-checkbox\");\n  var _component_router_link = _resolveComponent(\"router-link\");\n  var _component_el_input_number = _resolveComponent(\"el-input-number\");\n  var _component_el_skeleton = _resolveComponent(\"el-skeleton\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_cache[14] || (_cache[14] = _createElementVNode(\"div\", {\n    \"class\": \"page-header\"\n  }, [_createElementVNode(\"h1\", {\n    \"class\": \"page-title\"\n  }, \"我的购物车\")], -1 /* HOISTED */)), !$setup.loading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_createCommentVNode(\" 购物车为空 \"), !$setup.cartItems.length ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_createVNode(_component_el_empty, {\n    description: \"您的购物车还是空的\"\n  }, {\n    image: _withCtx(function () {\n      return [_createVNode(_component_el_icon, {\n        size: 100\n      }, {\n        \"default\": _withCtx(function () {\n          return [_createVNode(_component_ShoppingCart)];\n        }),\n        _: 1 /* STABLE */\n      })];\n    }),\n    \"default\": _withCtx(function () {\n      return [_createVNode(_component_el_button, {\n        type: \"primary\",\n        onClick: _cache[0] || (_cache[0] = function ($event) {\n          return _ctx.$router.push('/');\n        })\n      }, {\n        \"default\": _withCtx(function () {\n          return _cache[3] || (_cache[3] = [_createTextVNode(\"去购物\")]);\n        }),\n        _: 1 /* STABLE */\n      })];\n    }),\n    _: 1 /* STABLE */\n  })])) : (_openBlock(), _createElementBlock(_Fragment, {\n    key: 1\n  }, [_createCommentVNode(\" 购物车有商品 \"), _createElementVNode(\"div\", _hoisted_5, [_createCommentVNode(\" 购物车头部 \"), _createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"div\", _hoisted_7, [_createVNode(_component_el_checkbox, {\n    modelValue: $setup.selectAll,\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = function ($event) {\n      return $setup.selectAll = $event;\n    }),\n    onChange: $setup.handleSelectAllChange\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[4] || (_cache[4] = [_createTextVNode(\"全选\")]);\n    }),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\", \"onChange\"])]), _cache[5] || (_cache[5] = _createStaticVNode(\"<div class=\\\"cart-column item-column\\\" data-v-c028c34c>商品信息</div><div class=\\\"cart-column price-column\\\" data-v-c028c34c>单价</div><div class=\\\"cart-column quantity-column\\\" data-v-c028c34c>数量</div><div class=\\\"cart-column subtotal-column\\\" data-v-c028c34c>小计</div><div class=\\\"cart-column action-column\\\" data-v-c028c34c>操作</div>\", 5))]), _createCommentVNode(\" 购物车列表 \"), _createElementVNode(\"div\", _hoisted_8, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.cartItems, function (item) {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: item.id,\n      \"class\": \"cart-item\"\n    }, [_createElementVNode(\"div\", _hoisted_9, [_createVNode(_component_el_checkbox, {\n      modelValue: item.selected,\n      \"onUpdate:modelValue\": function onUpdateModelValue($event) {\n        return item.selected = $event;\n      },\n      onChange: $setup.handleItemSelectChange\n    }, null, 8 /* PROPS */, [\"modelValue\", \"onUpdate:modelValue\", \"onChange\"])]), _createElementVNode(\"div\", _hoisted_10, [_createElementVNode(\"div\", _hoisted_11, [_createVNode(_component_router_link, {\n      to: \"/product/\".concat(item.productId),\n      \"class\": \"item-image\"\n    }, {\n      \"default\": _withCtx(function () {\n        return [_createElementVNode(\"img\", {\n          src: item.image,\n          alt: item.name\n        }, null, 8 /* PROPS */, _hoisted_12)];\n      }),\n      _: 2 /* DYNAMIC */\n    }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"to\"]), _createElementVNode(\"div\", _hoisted_13, [_createVNode(_component_router_link, {\n      to: \"/product/\".concat(item.productId),\n      \"class\": \"item-name\"\n    }, {\n      \"default\": _withCtx(function () {\n        return [_createTextVNode(_toDisplayString(item.name), 1 /* TEXT */)];\n      }),\n      _: 2 /* DYNAMIC */\n    }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"to\"]), item.attrs ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(item.attrs, function (value, key) {\n      return _openBlock(), _createElementBlock(\"span\", {\n        key: key,\n        \"class\": \"item-attr\"\n      }, _toDisplayString(key) + \": \" + _toDisplayString(value), 1 /* TEXT */);\n    }), 128 /* KEYED_FRAGMENT */))])) : _createCommentVNode(\"v-if\", true)])])]), _createElementVNode(\"div\", _hoisted_15, [_createElementVNode(\"div\", _hoisted_16, \"¥\" + _toDisplayString($setup.formatPrice(item.price)), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_17, [_createVNode(_component_el_input_number, {\n      modelValue: item.quantity,\n      \"onUpdate:modelValue\": function onUpdateModelValue($event) {\n        return item.quantity = $event;\n      },\n      min: 1,\n      max: item.stock || 99,\n      size: \"small\",\n      onChange: function onChange(val) {\n        return $setup.handleQuantityChange(item.id, val);\n      }\n    }, null, 8 /* PROPS */, [\"modelValue\", \"onUpdate:modelValue\", \"max\", \"onChange\"])]), _createElementVNode(\"div\", _hoisted_18, [_createElementVNode(\"div\", _hoisted_19, \"¥\" + _toDisplayString($setup.formatPrice(item.price * item.quantity)), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_20, [_createVNode(_component_el_button, {\n      type: \"danger\",\n      link: \"\",\n      onClick: function onClick($event) {\n        return $setup.handleRemoveItem(item.id);\n      }\n    }, {\n      \"default\": _withCtx(function () {\n        return _toConsumableArray(_cache[6] || (_cache[6] = [_createTextVNode(\"删除\")]));\n      }),\n      _: 2 /* DYNAMIC */\n    }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])])]);\n  }), 128 /* KEYED_FRAGMENT */))]), _createCommentVNode(\" 结算栏 \"), _createElementVNode(\"div\", _hoisted_21, [_createElementVNode(\"div\", _hoisted_22, [_createVNode(_component_el_checkbox, {\n    modelValue: $setup.selectAll,\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = function ($event) {\n      return $setup.selectAll = $event;\n    }),\n    onChange: $setup.handleSelectAllChange\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[7] || (_cache[7] = [_createTextVNode(\"全选\")]);\n    }),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\", \"onChange\"]), _createVNode(_component_el_button, {\n    link: \"\",\n    onClick: $setup.handleRemoveSelected\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[8] || (_cache[8] = [_createTextVNode(\"删除选中\")]);\n    }),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"onClick\"]), _createVNode(_component_el_button, {\n    link: \"\",\n    onClick: $setup.handleClearCart\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[9] || (_cache[9] = [_createTextVNode(\"清空购物车\")]);\n    }),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"onClick\"])]), _createElementVNode(\"div\", _hoisted_23, [_createElementVNode(\"div\", _hoisted_24, [_createElementVNode(\"span\", null, [_cache[10] || (_cache[10] = _createTextVNode(\"已选 \")), _createElementVNode(\"span\", _hoisted_25, _toDisplayString($setup.selectedCount), 1 /* TEXT */), _cache[11] || (_cache[11] = _createTextVNode(\" 件商品\"))]), _createElementVNode(\"span\", _hoisted_26, [_cache[12] || (_cache[12] = _createTextVNode(\"总计：\")), _createElementVNode(\"span\", _hoisted_27, \"¥\" + _toDisplayString($setup.formatPrice($setup.totalAmount)), 1 /* TEXT */)])]), _createVNode(_component_el_button, {\n    type: \"primary\",\n    size: \"large\",\n    disabled: $setup.selectedCount === 0,\n    onClick: $setup.handleCheckout\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[13] || (_cache[13] = [_createTextVNode(\" 去结算 \")]);\n    }),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"disabled\", \"onClick\"])])])])], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))])) : (_openBlock(), _createElementBlock(_Fragment, {\n    key: 1\n  }, [_createCommentVNode(\" 加载状态 \"), _createElementVNode(\"div\", _hoisted_28, [_createVNode(_component_el_skeleton, {\n    rows: 5,\n    animated: \"\"\n  })])], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))])]);\n}","map":{"version":3,"names":["key","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","$setup","loading","_hoisted_3","_createCommentVNode","cartItems","length","_hoisted_4","_createVNode","_component_el_empty","description","image","_withCtx","_component_el_icon","size","_component_ShoppingCart","_","_component_el_button","type","onClick","_cache","$event","_ctx","$router","push","_createTextVNode","_Fragment","_hoisted_5","_hoisted_6","_hoisted_7","_component_el_checkbox","modelValue","selectAll","onChange","handleSelectAllChange","_createStaticVNode","_hoisted_8","_renderList","item","id","_hoisted_9","selected","onUpdateModelValue","handleItemSelectChange","_hoisted_10","_hoisted_11","_component_router_link","to","concat","productId","src","alt","name","_hoisted_12","_hoisted_13","_toDisplayString","attrs","_hoisted_14","value","_hoisted_15","_hoisted_16","formatPrice","price","_hoisted_17","_component_el_input_number","quantity","min","max","stock","val","handleQuantityChange","_hoisted_18","_hoisted_19","_hoisted_20","link","handleRemoveItem","_toConsumableArray","_hoisted_21","_hoisted_22","handleRemoveSelected","handleClearCart","_hoisted_23","_hoisted_24","_hoisted_25","selectedCount","_hoisted_26","_hoisted_27","totalAmount","disabled","handleCheckout","_hoisted_28","_component_el_skeleton","rows","animated"],"sources":["D:\\code\\project\\WhaleTide-1\\WhaleTide\\wt-client-web\\src\\views\\Cart.vue"],"sourcesContent":["<template>\r\n  <div class=\"cart-page\">\r\n    <div class=\"container\">\r\n      <div class=\"page-header\">\r\n        <h1 class=\"page-title\">我的购物车</h1>\r\n      </div>\r\n      \r\n      <div v-if=\"!loading\">\r\n        <!-- 购物车为空 -->\r\n        <div v-if=\"!cartItems.length\" class=\"empty-cart\">\r\n          <el-empty description=\"您的购物车还是空的\">\r\n            <template #image>\r\n              <el-icon :size=\"100\"><ShoppingCart /></el-icon>\r\n            </template>\r\n            <el-button type=\"primary\" @click=\"$router.push('/')\">去购物</el-button>\r\n          </el-empty>\r\n        </div>\r\n        \r\n        <!-- 购物车有商品 -->\r\n        <div v-else class=\"cart-content\">\r\n          <!-- 购物车头部 -->\r\n          <div class=\"cart-header\">\r\n            <div class=\"cart-column select-column\">\r\n              <el-checkbox v-model=\"selectAll\" @change=\"handleSelectAllChange\">全选</el-checkbox>\r\n            </div>\r\n            <div class=\"cart-column item-column\">商品信息</div>\r\n            <div class=\"cart-column price-column\">单价</div>\r\n            <div class=\"cart-column quantity-column\">数量</div>\r\n            <div class=\"cart-column subtotal-column\">小计</div>\r\n            <div class=\"cart-column action-column\">操作</div>\r\n          </div>\r\n          \r\n          <!-- 购物车列表 -->\r\n          <div class=\"cart-body\">\r\n            <div v-for=\"item in cartItems\" :key=\"item.id\" class=\"cart-item\">\r\n              <div class=\"cart-column select-column\">\r\n                <el-checkbox v-model=\"item.selected\" @change=\"handleItemSelectChange\"></el-checkbox>\r\n              </div>\r\n              \r\n              <div class=\"cart-column item-column\">\r\n                <div class=\"item-info\">\r\n                  <router-link :to=\"`/product/${item.productId}`\" class=\"item-image\">\r\n                    <img :src=\"item.image\" :alt=\"item.name\">\r\n                  </router-link>\r\n                  <div class=\"item-details\">\r\n                    <router-link :to=\"`/product/${item.productId}`\" class=\"item-name\">{{ item.name }}</router-link>\r\n                    <div class=\"item-attrs\" v-if=\"item.attrs\">\r\n                      <span v-for=\"(value, key) in item.attrs\" :key=\"key\" class=\"item-attr\">\r\n                        {{ key }}: {{ value }}\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              \r\n              <div class=\"cart-column price-column\">\r\n                <div class=\"price\">¥{{ formatPrice(item.price) }}</div>\r\n              </div>\r\n              \r\n              <div class=\"cart-column quantity-column\">\r\n                <el-input-number \r\n                  v-model=\"item.quantity\" \r\n                  :min=\"1\" \r\n                  :max=\"item.stock || 99\" \r\n                  size=\"small\"\r\n                  @change=\"(val) => handleQuantityChange(item.id, val)\"\r\n                ></el-input-number>\r\n              </div>\r\n              \r\n              <div class=\"cart-column subtotal-column\">\r\n                <div class=\"subtotal\">¥{{ formatPrice(item.price * item.quantity) }}</div>\r\n              </div>\r\n              \r\n              <div class=\"cart-column action-column\">\r\n                <el-button type=\"danger\" link @click=\"handleRemoveItem(item.id)\">删除</el-button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          <!-- 结算栏 -->\r\n          <div class=\"cart-footer\">\r\n            <div class=\"footer-left\">\r\n              <el-checkbox v-model=\"selectAll\" @change=\"handleSelectAllChange\">全选</el-checkbox>\r\n              <el-button link @click=\"handleRemoveSelected\">删除选中</el-button>\r\n              <el-button link @click=\"handleClearCart\">清空购物车</el-button>\r\n            </div>\r\n            \r\n            <div class=\"footer-right\">\r\n              <div class=\"cart-total\">\r\n                <span>已选 <span class=\"selected-count\">{{ selectedCount }}</span> 件商品</span>\r\n                <span class=\"total-amount\">总计：<span class=\"amount\">¥{{ formatPrice(totalAmount) }}</span></span>\r\n              </div>\r\n              <el-button \r\n                type=\"primary\" \r\n                size=\"large\" \r\n                :disabled=\"selectedCount === 0\"\r\n                @click=\"handleCheckout\"\r\n              >\r\n                去结算\r\n              </el-button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      <!-- 加载状态 -->\r\n      <div v-else class=\"loading-container\">\r\n        <el-skeleton :rows=\"5\" animated />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, computed, onMounted, watch } from 'vue';\r\nimport { useRouter } from 'vue-router';\r\nimport { ElMessage, ElMessageBox } from 'element-plus';\r\nimport { ShoppingCart } from '@element-plus/icons-vue';\r\nimport api from '../api';\r\n\r\nexport default {\r\n  name: 'ShoppingCart',\r\n  components: {\r\n    ShoppingCart\r\n  },\r\n  setup() {\r\n    const router = useRouter();\r\n    const cartItems = ref([]);\r\n    const loading = ref(false);\r\n    const selectAll = ref(false);\r\n    \r\n    // 获取购物车数据\r\n    const fetchCartData = async () => {\r\n      try {\r\n        loading.value = true;\r\n        const result = await api.cart.getCartList();\r\n        cartItems.value = result.items || [];\r\n        updateSelectAll();\r\n      } catch (error) {\r\n        ElMessage.error('获取购物车数据失败');\r\n        console.error(error);\r\n      } finally {\r\n        loading.value = false;\r\n      }\r\n    };\r\n    \r\n    // 计算已选中商品总数\r\n    const selectedCount = computed(() => {\r\n      return cartItems.value.filter(item => item.selected).length;\r\n    });\r\n    \r\n    // 计算已选中商品总金额\r\n    const totalAmount = computed(() => {\r\n      return cartItems.value\r\n        .filter(item => item.selected)\r\n        .reduce((total, item) => total + item.price * item.quantity, 0);\r\n    });\r\n    \r\n    // 更新全选状态\r\n    const updateSelectAll = () => {\r\n      selectAll.value = cartItems.value.length > 0 && \r\n        cartItems.value.every(item => item.selected);\r\n    };\r\n    \r\n    // 处理全选/取消全选\r\n    const handleSelectAllChange = (val) => {\r\n      cartItems.value.forEach(item => {\r\n        item.selected = val;\r\n      });\r\n      \r\n      // 同步到服务器\r\n      api.cart.selectAllCartItems(val).catch(error => {\r\n        ElMessage.error('操作失败');\r\n        console.error(error);\r\n      });\r\n    };\r\n    \r\n    // 处理单个商品选中状态变化\r\n    const handleItemSelectChange = () => {\r\n      updateSelectAll();\r\n      \r\n      // 可以在这里做进一步的服务器同步操作\r\n    };\r\n    \r\n    // 处理商品数量变化\r\n    const handleQuantityChange = debounce(async (itemId, quantity) => {\r\n      try {\r\n        await api.cart.updateCartItemQuantity(itemId, quantity);\r\n      } catch (error) {\r\n        ElMessage.error('更新数量失败');\r\n        console.error(error);\r\n        // 回滚UI状态\r\n        await fetchCartData();\r\n      }\r\n    }, 500);\r\n    \r\n    // 删除购物车商品\r\n    const handleRemoveItem = (itemId) => {\r\n      ElMessageBox.confirm('确定要从购物车中删除该商品吗？', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).then(async () => {\r\n        try {\r\n          await api.cart.removeCartItem(itemId);\r\n          cartItems.value = cartItems.value.filter(item => item.id !== itemId);\r\n          ElMessage.success('已从购物车移除');\r\n          updateSelectAll();\r\n        } catch (error) {\r\n          ElMessage.error('删除失败');\r\n          console.error(error);\r\n        }\r\n      }).catch(() => {\r\n        // 用户取消删除\r\n      });\r\n    };\r\n    \r\n    // 删除选中商品\r\n    const handleRemoveSelected = () => {\r\n      if (selectedCount.value === 0) {\r\n        ElMessage.warning('请先选择商品');\r\n        return;\r\n      }\r\n      \r\n      ElMessageBox.confirm('确定要删除选中的商品吗？', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).then(async () => {\r\n        try {\r\n          const selectedIds = cartItems.value\r\n            .filter(item => item.selected)\r\n            .map(item => item.id);\r\n            \r\n          // 假设后端提供批量删除接口\r\n          await Promise.all(selectedIds.map(id => api.cart.removeCartItem(id)));\r\n          \r\n          cartItems.value = cartItems.value.filter(item => !item.selected);\r\n          ElMessage.success('已删除选中商品');\r\n          updateSelectAll();\r\n        } catch (error) {\r\n          ElMessage.error('删除失败');\r\n          console.error(error);\r\n        }\r\n      }).catch(() => {\r\n        // 用户取消删除\r\n      });\r\n    };\r\n    \r\n    // 清空购物车\r\n    const handleClearCart = () => {\r\n      if (cartItems.value.length === 0) {\r\n        ElMessage.warning('购物车已经是空的');\r\n        return;\r\n      }\r\n      \r\n      ElMessageBox.confirm('确定要清空购物车吗？', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).then(async () => {\r\n        try {\r\n          await api.cart.clearCart();\r\n          cartItems.value = [];\r\n          ElMessage.success('购物车已清空');\r\n        } catch (error) {\r\n          ElMessage.error('操作失败');\r\n          console.error(error);\r\n        }\r\n      }).catch(() => {\r\n        // 用户取消操作\r\n      });\r\n    };\r\n    \r\n    // 去结算\r\n    const handleCheckout = () => {\r\n      if (selectedCount.value === 0) {\r\n        ElMessage.warning('请先选择商品');\r\n        return;\r\n      }\r\n      \r\n      router.push('/checkout');\r\n    };\r\n    \r\n    // 工具函数：价格格式化\r\n    const formatPrice = (price) => {\r\n      return price.toFixed(2);\r\n    };\r\n    \r\n    // 工具函数：防抖\r\n    function debounce(fn, delay) {\r\n      let timer = null;\r\n      return function(...args) {\r\n        if (timer) clearTimeout(timer);\r\n        timer = setTimeout(() => {\r\n          fn.apply(this, args);\r\n        }, delay);\r\n      };\r\n    }\r\n    \r\n    onMounted(() => {\r\n      fetchCartData();\r\n    });\r\n    \r\n    return {\r\n      cartItems,\r\n      loading,\r\n      selectAll,\r\n      selectedCount,\r\n      totalAmount,\r\n      formatPrice,\r\n      handleSelectAllChange,\r\n      handleItemSelectChange,\r\n      handleQuantityChange,\r\n      handleRemoveItem,\r\n      handleRemoveSelected,\r\n      handleClearCart,\r\n      handleCheckout\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.cart-page {\r\n  padding: 20px 0;\r\n}\r\n\r\n.page-header {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.page-title {\r\n  font-size: 24px;\r\n  font-weight: 500;\r\n  color: #333;\r\n}\r\n\r\n.empty-cart {\r\n  background-color: white;\r\n  border-radius: 4px;\r\n  padding: 60px 0;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n}\r\n\r\n.empty-cart-image {\r\n  width: 200px;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.empty-cart-text {\r\n  font-size: 16px;\r\n  color: #666;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.cart-content {\r\n  background-color: white;\r\n  border-radius: 4px;\r\n}\r\n\r\n.cart-header {\r\n  display: flex;\r\n  padding: 15px;\r\n  border-bottom: 1px solid #f0f0f0;\r\n  font-weight: 500;\r\n  color: #333;\r\n}\r\n\r\n.cart-column {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.select-column {\r\n  width: 80px;\r\n}\r\n\r\n.item-column {\r\n  flex: 1;\r\n}\r\n\r\n.price-column,\r\n.quantity-column,\r\n.subtotal-column {\r\n  width: 160px;\r\n  justify-content: center;\r\n}\r\n\r\n.action-column {\r\n  width: 100px;\r\n  justify-content: center;\r\n}\r\n\r\n.cart-item {\r\n  display: flex;\r\n  padding: 20px 15px;\r\n  border-bottom: 1px solid #f0f0f0;\r\n}\r\n\r\n.item-info {\r\n  display: flex;\r\n}\r\n\r\n.item-image {\r\n  width: 80px;\r\n  height: 80px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  background-color: #f9f9f9;\r\n  border-radius: 4px;\r\n  margin-right: 15px;\r\n}\r\n\r\n.item-image img {\r\n  max-width: 90%;\r\n  max-height: 90%;\r\n  object-fit: contain;\r\n}\r\n\r\n.item-details {\r\n  flex: 1;\r\n}\r\n\r\n.item-name {\r\n  font-size: 14px;\r\n  color: #333;\r\n  margin-bottom: 8px;\r\n  display: -webkit-box;\r\n  -webkit-line-clamp: 2;\r\n  -webkit-box-orient: vertical;\r\n  overflow: hidden;\r\n}\r\n\r\n.item-attrs {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 8px;\r\n}\r\n\r\n.item-attr {\r\n  font-size: 12px;\r\n  color: #999;\r\n  background-color: #f5f5f5;\r\n  padding: 2px 8px;\r\n  border-radius: 2px;\r\n}\r\n\r\n.price,\r\n.subtotal {\r\n  font-size: 16px;\r\n}\r\n\r\n.subtotal {\r\n  color: #ff6700;\r\n  font-weight: 500;\r\n}\r\n\r\n.cart-footer {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 20px 15px;\r\n  background-color: #fafafa;\r\n}\r\n\r\n.footer-left {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 15px;\r\n}\r\n\r\n.footer-right {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 20px;\r\n}\r\n\r\n.cart-total {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: flex-end;\r\n}\r\n\r\n.selected-count {\r\n  color: #ff6700;\r\n  font-weight: bold;\r\n}\r\n\r\n.total-amount {\r\n  margin-top: 5px;\r\n  font-size: 16px;\r\n}\r\n\r\n.amount {\r\n  color: #ff6700;\r\n  font-size: 24px;\r\n  font-weight: bold;\r\n}\r\n\r\n.loading-container {\r\n  background-color: white;\r\n  border-radius: 4px;\r\n  padding: 20px;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}