{"ast":null,"code":"function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nimport { inject, ref, computed, unref, watch, onMounted } from 'vue';\nimport { isUndefined } from 'lodash-unified';\nimport { POPPER_INJECTION_KEY } from '../constants.mjs';\nimport { buildPopperOptions, unwrapMeasurableEl } from '../utils.mjs';\nimport { usePopper } from '../../../../hooks/use-popper/index.mjs';\nvar DEFAULT_ARROW_OFFSET = 0;\nvar usePopperContent = function usePopperContent(props) {\n  var _inject = inject(POPPER_INJECTION_KEY, void 0),\n    popperInstanceRef = _inject.popperInstanceRef,\n    contentRef = _inject.contentRef,\n    triggerRef = _inject.triggerRef,\n    role = _inject.role;\n  var arrowRef = ref();\n  var arrowOffset = computed(function () {\n    return props.arrowOffset;\n  });\n  var eventListenerModifier = computed(function () {\n    return {\n      name: \"eventListeners\",\n      enabled: !!props.visible\n    };\n  });\n  var arrowModifier = computed(function () {\n    var _a;\n    var arrowEl = unref(arrowRef);\n    var offset = (_a = unref(arrowOffset)) != null ? _a : DEFAULT_ARROW_OFFSET;\n    return {\n      name: \"arrow\",\n      enabled: !isUndefined(arrowEl),\n      options: {\n        element: arrowEl,\n        padding: offset\n      }\n    };\n  });\n  var options = computed(function () {\n    return _objectSpread({\n      onFirstUpdate: function onFirstUpdate() {\n        update();\n      }\n    }, buildPopperOptions(props, [unref(arrowModifier), unref(eventListenerModifier)]));\n  });\n  var computedReference = computed(function () {\n    return unwrapMeasurableEl(props.referenceEl) || unref(triggerRef);\n  });\n  var _usePopper = usePopper(computedReference, contentRef, options),\n    attributes = _usePopper.attributes,\n    state = _usePopper.state,\n    styles = _usePopper.styles,\n    update = _usePopper.update,\n    forceUpdate = _usePopper.forceUpdate,\n    instanceRef = _usePopper.instanceRef;\n  watch(instanceRef, function (instance) {\n    return popperInstanceRef.value = instance;\n  }, {\n    flush: \"sync\"\n  });\n  onMounted(function () {\n    watch(function () {\n      var _a;\n      return (_a = unref(computedReference)) == null ? void 0 : _a.getBoundingClientRect();\n    }, function () {\n      update();\n    });\n  });\n  return {\n    attributes: attributes,\n    arrowRef: arrowRef,\n    contentRef: contentRef,\n    instanceRef: instanceRef,\n    state: state,\n    styles: styles,\n    role: role,\n    forceUpdate: forceUpdate,\n    update: update\n  };\n};\nexport { usePopperContent };","map":{"version":3,"names":["DEFAULT_ARROW_OFFSET","usePopperContent","props","_inject","inject","POPPER_INJECTION_KEY","popperInstanceRef","contentRef","triggerRef","role","arrowRef","ref","arrowOffset","computed","eventListenerModifier","name","enabled","visible","arrowModifier","_a","arrowEl","unref","offset","isUndefined","options","element","padding","_objectSpread","onFirstUpdate","update","buildPopperOptions","computedReference","unwrapMeasurableEl","referenceEl","_usePopper","usePopper","attributes","state","styles","forceUpdate","instanceRef","watch","instance","value","flush","onMounted","getBoundingClientRect"],"sources":["../../../../../../../packages/components/popper/src/composables/use-content.ts"],"sourcesContent":["import { computed, inject, onMounted, ref, unref, watch } from 'vue'\nimport { isUndefined } from 'lodash-unified'\nimport { usePopper } from '@element-plus/hooks'\nimport { POPPER_INJECTION_KEY } from '../constants'\nimport { buildPopperOptions, unwrapMeasurableEl } from '../utils'\n\nimport type { Modifier } from '@popperjs/core'\nimport type { PartialOptions } from '@element-plus/hooks'\nimport type { PopperContentProps } from '../content'\n\nconst DEFAULT_ARROW_OFFSET = 0\n\nexport const usePopperContent = (props: PopperContentProps) => {\n  const { popperInstanceRef, contentRef, triggerRef, role } = inject(\n    POPPER_INJECTION_KEY,\n    undefined\n  )!\n\n  const arrowRef = ref<HTMLElement>()\n  const arrowOffset = computed(() => props.arrowOffset)\n\n  const eventListenerModifier = computed(() => {\n    return {\n      name: 'eventListeners',\n      enabled: !!props.visible,\n    } as Modifier<'eventListeners', any>\n  })\n\n  const arrowModifier = computed(() => {\n    const arrowEl = unref(arrowRef)\n    const offset = unref(arrowOffset) ?? DEFAULT_ARROW_OFFSET\n    // Seems like the `phase` and `fn` is required by Modifier type\n    // But on its documentation they didn't specify that.\n    // Refer to https://popper.js.org/docs/v2/modifiers/arrow/\n    return {\n      name: 'arrow',\n      enabled: !isUndefined(arrowEl),\n      options: {\n        element: arrowEl,\n        padding: offset,\n      },\n    } as any\n  })\n\n  const options = computed<PartialOptions>(() => {\n    return {\n      onFirstUpdate: () => {\n        update()\n      },\n      ...buildPopperOptions(props, [\n        unref(arrowModifier),\n        unref(eventListenerModifier),\n      ]),\n    }\n  })\n\n  const computedReference = computed(\n    () => unwrapMeasurableEl(props.referenceEl) || unref(triggerRef)\n  )\n\n  const { attributes, state, styles, update, forceUpdate, instanceRef } =\n    usePopper(computedReference, contentRef, options)\n\n  watch(instanceRef, (instance) => (popperInstanceRef.value = instance), {\n    flush: 'sync',\n  })\n\n  onMounted(() => {\n    watch(\n      () => unref(computedReference)?.getBoundingClientRect(),\n      () => {\n        update()\n      }\n    )\n  })\n\n  return {\n    attributes,\n    arrowRef,\n    contentRef,\n    instanceRef,\n    state,\n    styles,\n    role,\n\n    forceUpdate,\n    update,\n  }\n}\n\nexport type UsePopperContentReturn = ReturnType<typeof usePopperContent>\n"],"mappings":";;;;;;;;;;;AAKA,IAAMA,oBAAoB,GAAG,CAAC;AAClB,IAACC,gBAAgB,GAAG,SAAnBA,gBAAgBA,CAAIC,KAAK,EAAK;EACzC,IAAAC,OAAA,GAA4DC,MAAM,CAACC,oBAAoB,EAAE,KAAK,CAAC,CAAC;IAAxFC,iBAAiB,GAAAH,OAAA,CAAjBG,iBAAiB;IAAEC,UAAU,GAAAJ,OAAA,CAAVI,UAAU;IAAEC,UAAU,GAAAL,OAAA,CAAVK,UAAU;IAAEC,IAAI,GAAAN,OAAA,CAAJM,IAAI;EACvD,IAAMC,QAAQ,GAAGC,GAAG,EAAE;EACtB,IAAMC,WAAW,GAAGC,QAAQ,CAAC;IAAA,OAAMX,KAAK,CAACU,WAAW;EAAA,EAAC;EACrD,IAAME,qBAAqB,GAAGD,QAAQ,CAAC,YAAM;IAC3C,OAAO;MACLE,IAAI,EAAE,gBAAgB;MACtBC,OAAO,EAAE,CAAC,CAACd,KAAK,CAACe;IACvB,CAAK;EACL,CAAG,CAAC;EACF,IAAMC,aAAa,GAAGL,QAAQ,CAAC,YAAM;IACnC,IAAIM,EAAE;IACN,IAAMC,OAAO,GAAGC,KAAK,CAACX,QAAQ,CAAC;IAC/B,IAAMY,MAAM,GAAG,CAACH,EAAE,GAAGE,KAAK,CAACT,WAAW,CAAC,KAAK,IAAI,GAAGO,EAAE,GAAGnB,oBAAoB;IAC5E,OAAO;MACLe,IAAI,EAAE,OAAO;MACbC,OAAO,EAAE,CAACO,WAAW,CAACH,OAAO,CAAC;MAC9BI,OAAO,EAAE;QACPC,OAAO,EAAEL,OAAO;QAChBM,OAAO,EAAEJ;MACjB;IACA,CAAK;EACL,CAAG,CAAC;EACF,IAAME,OAAO,GAAGX,QAAQ,CAAC,YAAM;IAC7B,OAAAc,aAAA;MACEC,aAAa,EAAE,SAAfA,aAAaA,CAAA,EAAQ;QACnBC,MAAM,EAAE;MAChB;IAAO,GACEC,kBAAkB,CAAC5B,KAAK,EAAE,CAC3BmB,KAAK,CAACH,aAAa,CAAC,EACpBG,KAAK,CAACP,qBAAqB,CAAC,CAC7B,CAAC;EAER,CAAG,CAAC;EACF,IAAMiB,iBAAiB,GAAGlB,QAAQ,CAAC;IAAA,OAAMmB,kBAAkB,CAAC9B,KAAK,CAAC+B,WAAW,CAAC,IAAIZ,KAAK,CAACb,UAAU,CAAC;EAAA,EAAC;EACpG,IAAA0B,UAAA,GAAwEC,SAAS,CAACJ,iBAAiB,EAAExB,UAAU,EAAEiB,OAAO,CAAC;IAAjHY,UAAU,GAAAF,UAAA,CAAVE,UAAU;IAAEC,KAAK,GAAAH,UAAA,CAALG,KAAK;IAAEC,MAAM,GAAAJ,UAAA,CAANI,MAAM;IAAET,MAAM,GAAAK,UAAA,CAANL,MAAM;IAAEU,WAAW,GAAAL,UAAA,CAAXK,WAAW;IAAEC,WAAW,GAAAN,UAAA,CAAXM,WAAW;EACnEC,KAAK,CAACD,WAAW,EAAE,UAACE,QAAQ;IAAA,OAAKpC,iBAAiB,CAACqC,KAAK,GAAGD,QAAQ;EAAA,GAAE;IACnEE,KAAK,EAAE;EACX,CAAG,CAAC;EACFC,SAAS,CAAC,YAAM;IACdJ,KAAK,CAAC,YAAM;MACV,IAAItB,EAAE;MACN,OAAO,CAACA,EAAE,GAAGE,KAAK,CAACU,iBAAiB,CAAC,KAAK,IAAI,GAAG,KAAK,CAAC,GAAGZ,EAAE,CAAC2B,qBAAqB,EAAE;IAC1F,CAAK,EAAE,YAAM;MACPjB,MAAM,EAAE;IACd,CAAK,CAAC;EACN,CAAG,CAAC;EACF,OAAO;IACLO,UAAU,EAAVA,UAAU;IACV1B,QAAQ,EAARA,QAAQ;IACRH,UAAU,EAAVA,UAAU;IACViC,WAAW,EAAXA,WAAW;IACXH,KAAK,EAALA,KAAK;IACLC,MAAM,EAANA,MAAM;IACN7B,IAAI,EAAJA,IAAI;IACJ8B,WAAW,EAAXA,WAAW;IACXV,MAAM,EAANA;EACJ,CAAG;AACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}